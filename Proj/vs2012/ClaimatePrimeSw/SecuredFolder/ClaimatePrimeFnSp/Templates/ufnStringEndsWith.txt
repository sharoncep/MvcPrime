SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

-- 

CREATE FUNCTION [[xTABLE_SCHEMAx]].[ufn_StringEndsWith] 
(
	@Expr	VARCHAR(MAX)
	, @Ends	VARCHAR(5000)
)
RETURNS BIT
AS
BEGIN
	DECLARE @RET_ANS BIT;
	SELECT @RET_ANS = 0;
	
	SELECT @Expr = LTRIM(RTRIM(@Expr));
	SELECT @Ends = LTRIM(RTRIM(@Ends));
	
	DECLARE @EXPR_LEN INT;
	SELECT @EXPR_LEN = LEN(@Expr);
	
	DECLARE @ENDS_LEN INT;
	SELECT @ENDS_LEN = LEN(@Ends);
	
	IF @EXPR_LEN > 0 AND @ENDS_LEN > 0
	BEGIN
		DECLARE @SUB_STR VARCHAR(5000);
		SELECT @SUB_STR = SUBSTRING(@Expr, (@EXPR_LEN - @ENDS_LEN + 1), @EXPR_LEN);
		
		IF UPPER(@SUB_STR) = UPPER(@Ends)
		BEGIN
			SELECT @RET_ANS = 1;
		END
	END

	RETURN @RET_ANS;
	
	-- SELECT [[xTABLE_SCHEMAx]].[ufn_StringEndsWith] ('SRSENTHIL', 'IL') AS RES
END

GO
